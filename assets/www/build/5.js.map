{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"5.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { LoginPage } from './login';\r\nimport { PipesModule } from \"../../app/pipe.module\";\r\n\r\n@NgModule({\r\n  declarations: [\r\n    LoginPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(LoginPage),\r\n    PipesModule\r\n  ],\r\n  exports: [\r\n    LoginPage\r\n  ]\r\n})\r\nexport class LoginPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { Component, OnInit, OnDestroy, ChangeDetectorRef } from '@angular/core';\r\nimport { IonicPage, NavController, LoadingController, Loading } from 'ionic-angular';\r\nimport { LocaldataProvider } from \"../../providers/localdata/localdata\";\r\nimport { LoginProvider } from \"../../providers/login/login\";\r\nimport { SignalrWindow } from \"../../providers/constants/constants\";\r\n@IonicPage({\r\n  name: 'login',\r\n  segment: 'login'\r\n})\r\n@Component({\r\n  selector: 'page-login',\r\n  templateUrl: 'login.html'//,\r\n  //providers: [LocaldataProvider,LocaldataProvider]\r\n})\r\nexport class LoginPage implements OnInit, OnDestroy {\r\n  showWeiXinLogin: boolean = true;\r\n  disable: boolean = false;\r\n  loading: Loading;\r\n\r\n  ValidNumber: string;\r\n  phoneNum: string;\r\n  showType: string;\r\n  mobile: string;\r\n  unionid: string;\r\n  nickname: string;\r\n  avator: string;\r\n  Countdown: 120;\r\n  second: number = 0;\r\n  firstSend: boolean = true;\r\n  //输入的短信验证码\r\n  verificationCode: string;\r\n  canSend: boolean = true;\r\n  intervalVal: any;\r\n  cordova: any;\r\n  constructor(public navCtrl: NavController, private lp: LocaldataProvider,\r\n    private loadingCtrl: LoadingController, private loginp: LoginProvider,\r\n    private window: SignalrWindow, private ref: ChangeDetectorRef) {\r\n\r\n  }\r\n  ngOnInit() {\r\n\r\n    this.ref.markForCheck();\r\n    var token = this.lp.getToken();\r\n    if (token != null && token != \"\") {\r\n      //token不为空就跳转到首页?如果token过期呢?\r\n      //todo?\r\n      this.navCtrl.push(\"tabs\");\r\n    }\r\n  }\r\n  ngOnDestroy() {\r\n    this.ref.detach();\r\n  }\r\n  getVerificationCode() {\r\n    //发送短信码\r\n    this.canSend = false;\r\n    this.second = 120;\r\n    this.firstSend = false;\r\n    this.intervalVal = setInterval(() => {\r\n      if (this.second > 0) {\r\n        this.second = this.second - 1;\r\n      }\r\n      if (this.second <= 0) {\r\n        clearInterval(this.intervalVal);\r\n        this.canSend = true;\r\n      }\r\n    }, 1000)\r\n    //发送短信验证码\r\n    this.loginp.LoginSendCode(this.mobile, 3).subscribe(data => {\r\n      console.log(data);\r\n      if (data.error_code == 1) {\r\n        this.lp.alert(\"提示\", \"手机号没有注册，请点击‘注册’按钮进行注册\");\r\n      }\r\n      this.ref.detectChanges();\r\n    }, fail => {\r\n      console.log(fail);\r\n      this.lp.alert(\"提示\", \"服务器连接失败，请稍后再试。\");\r\n    });\r\n    this.ref.detectChanges();\r\n  }\r\n\r\n  loadingInit() {\r\n    this.loading = this.loadingCtrl.create({\r\n      content: '请稍等...',\r\n      dismissOnPageChange: true\r\n    });\r\n  }\r\n  loadingEnd(obj) {\r\n    obj.loading.dismissAll();\r\n    obj.loading = null;\r\n  }\r\n  submitVerficationCode() {\r\n    //短信码登录\r\n    this.loadingInit();\r\n\r\n    this.loading.present().then(() => {\r\n      //验证通过 更新手机号码\r\n\r\n      this.disable = true;\r\n\r\n      this.loginp.Login(this.ValidNumber, 3, this.mobile, this.nickname, this.unionid, this.avator).subscribe(data => {\r\n        this.loadingEnd(this);\r\n        if (data.error_code != 0) {\r\n          this.disable = false;\r\n          this.lp.alert(\"错误\", data.error_message);\r\n        } else {\r\n          console.log(\"登錄成功\");\r\n          //todo 路由 \r\n          this.setToken(data.data.access_token);\r\n          // this.navCtrl.push(\"tabs\");\r\n        }\r\n      }, error => {\r\n\r\n        this.disable = false;\r\n        this.loadingEnd(this);\r\n        console.log(error);\r\n        this.lp.alert(\"提示\", \"服务器链接失败，请稍后再试。\");\r\n      });\r\n      this.ref.detectChanges();\r\n    });\r\n\r\n  }\r\n\r\n  setToken(token: string) {\r\n    this.lp.setToken(token);\r\n    var locaturl = this.window.nativeWindow.location.toString();\r\n    locaturl = locaturl.substring(0, locaturl.lastIndexOf('#'));\r\n    this.window.nativeWindow.location.replace(locaturl);\r\n  }\r\n  getUser(cb: any, obj: any) {\r\n    obj.loginp.getMyInfo().subscribe(\r\n      data => {\r\n        cb && cb(data);\r\n      },\r\n      err => { console.log(err) });\r\n  }\r\n\r\n\r\n  //所有产品列表\r\n  getFindProductAll(cb: any) {\r\n    this.loginp.getFindProductAll().subscribe(\r\n      data => {\r\n        cb && cb(data);\r\n      },\r\n      err => { console.log(err) });\r\n  }\r\n}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}